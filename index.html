<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Wrap image in 3D cylinder - 2 | CSSDeck</title>
  <link rel="stylesheet" type="text/css" href="./index.css">
</head>

<body>
  <div id="container">
    <h1>image wrapped around a cylindrical shape</h1>
    <div class="cylindrical-product-display-container cpdc">
      <div class="product">
        <img
          src="https://mms-images.staging.customink.com/mms/images/catalog/colors/364000/views/back.jpg?digest=6cf15c94c3292e10bac13082301b4f12"
          class="product-imagery">
      </div>
      <div class="cylindrical-container">
        <img
          src="https://mms-images.staging.customink.com/mms/images/catalog/colors/364000/views/back.jpg?digest=6cf15c94c3292e10bac13082301b4f12"
          class="product-imagery">
        <div class="warped-rectangle">
          <div class="section s1"></div>
          <div class="section s2"></div>
          <div class="section s3"></div>
          <div class="section s4"></div>
          <div class="section s5"></div>
          <div class="section s6"></div>
          <div class="section s7"></div>
          <div class="section s8"></div>
          <div class="section s9"></div>
          <div class="section s10"></div>
          <div class="section s11"></div>
          <div class="section s12"></div>
          <div class="section s13"></div>
          <div class="section s14"></div>
          <div class="section s15"></div>
          <div class="section s16"></div>
          <div class="section s17"></div>
          <div class="section s18"></div>
          <div class="section s19"></div>
          <div class="section s20"></div>
          <div class="section s21"></div>
          <div class="section s22"></div>
          <div class="section s23"></div>
          <div class="section s24"></div>
          <div class="section s25"></div>
          <div class="section s26"></div>
          <div class="section s27"></div>
          <div class="section s28"></div>
          <div class="section s29"></div>
          <div class="section s30"></div>
          <div class="section s31"></div>
          <div class="section s32"></div>
          <div class="section s33"></div>
          <div class="section s34"></div>
          <div class="section s35"></div>
          <div class="section s36"></div>
          <div class="section s37"></div>
          <div class="section s38"></div>
          <div class="section s39"></div>
          <div class="section s40"></div>
          <div class="section s41"></div>
          <div class="section s42"></div>
          <div class="section s43"></div>
          <div class="section s44"></div>
          <div class="section s45"></div>
          <div class="section s46"></div>
          <div class="section s47"></div>
          <div class="section s48"></div>
          <div class="section s49"></div>
          <div class="section s50"></div>
          <div class="section s51"></div>
          <div class="section s52"></div>
          <div class="section s53"></div>
          <div class="section s54"></div>
          <div class="section s55"></div>
          <div class="section s56"></div>
          <div class="section s57"></div>
          <div class="section s58"></div>
          <div class="section s59"></div>
          <div class="section s60"></div>
          <div class="section s61"></div>
          <div class="section s62"></div>
          <div class="section s63"></div>
          <div class="section s64"></div>
          <div class="section s65"></div>
          <div class="section s66"></div>
          <div class="section s67"></div>
          <div class="section s68"></div>
          <div class="section s69"></div>
          <div class="section s70"></div>
          <div class="section s71"></div>
          <div class="section s72"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // References: 
    // https://24ways.org/2010/intro-to-css-3d-transforms/
    // https://css-tricks.com/almanac/properties/t/transform/

    //anim-infinite-rotation -> start anim

    //.warped-rectangle -> item selector
    //document.querySelectorAll(".warped-rectangle .section");
    //.warped-rectangle .section {
    //   position: absolute;
    //   /* background: url("https://design-raster.out.customink.com/designs/svv0-00ck-6rxn/front.png"); */
    //   background: url("https://mms-images.staging.customink.com/mms/images/catalog/colors/364000/views/back.jpg?digest=6cf15c94c3292e10bac13082301b4f12");
    //   border-width: thin 0;
    //   height: 500px;
    //   width: 34px;
    //   opacity: 1;
    //   border: 1px solid transparent;
    // }

    const imgWidth = 900;

    const cylinderSides = document.querySelectorAll(".warped-rectangle .section");

    const numSections = cylinderSides.length;
    const yRectSectionRotationIncrement = 360 / numSections;

    const imgWidthIncrement = (imgWidth / numSections);
    const translateZ = (imgWidth / (2 * Math.PI));

    let rectSectionYRotation = 0;
    let rectSectionXRotation = 0;
    let rectSectionZRotation = 0;
    let sectionImgWidth = imgWidth;

    cylinderSides.forEach((cylinderPart, idx) => {
      cylinderPart.style['width'] = `${imgWidthIncrement}px`;

      if (idx === 0) {
        cylinderPart.style['background-position'] = `0 -1`;
      } else {
        sectionImgWidth -= imgWidthIncrement;
        cylinderPart.style['background-position'] = `${sectionImgWidth}px -1`;
      }

      cylinderPart.style['-moz-transform'] = `rotateX(${rectSectionXRotation}deg) rotateY(${rectSectionYRotation}deg) rotateZ(${rectSectionZRotation}) translateZ(${translateZ}px)`;
      cylinderPart.style['-webkit-transform'] = `rotateX(${rectSectionXRotation}deg) rotateY(${rectSectionYRotation}deg) rotateZ(${rectSectionZRotation}) translateZ(${translateZ}px)`;

      rectSectionYRotation += yRectSectionRotationIncrement;
    });
  </script>

</html>